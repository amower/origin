<!DOCTYPE html>
<html>
    <head>
        <meta charset='UTF-8' />
        <title>Update Book</title>
    </head>
    <body>
        <!--Access book data-->
        <% @book.all do |b| %>
        
        <!--MENU-->
        <a href="/home/">Home</a>
        <a href="/accounts/<%= b.account_id %>">Account</a>
        <a href="/dashboard/<%= b.account_id %>">Dashboard</a>
        <a href="/activities/<%= b.account_id %>">Activities</a>
        <a href="/books/<%= b.account_id %>">Books</a>
        <a href="/subjects/<%= b.account_id %>">Subjects</a>
        
        <h1>Update Book</h1>
        
        <!--Form prefilled with current book info but checkboxes unchecked-->
        <form method="post" action="/books/create/<%= b.account_id %>/<%= b.pk %>">
            <table>
                <tr>
                    <td><label for="title">Title:</label></td>
                    <td><input type="text" name="title" value="<%= b.title %>"></td>
                </tr>
                <tr>
                    <td><label for="author">Author(Last, First):</label></td>
                    <td><input type="text" name="author" value="<%= b.author %>"></td>
                </tr>
                <tr>
                    <td><label for="fiction">Fiction:</label><input type="checkbox" name="fiction" value="1"></td>
                    <td><label for="nonfiction">Nonfiction:</label><input type="checkbox" name="nonfiction" value="1"></td>
                </tr>
                <tr>
                    <td><label for="rating">Rating(1-5):</label></td>
                    <td><input type="number" name="rating" value="<%= b.rating %>"></td>
                </tr>
                <tr>
                    <td><label for="finish_date">Date Finished:</label></td>
                    <td><input type="date" name="finish_date" value="<%= b.finish_date %>"></td>
                </tr>
                
                <!--Checkbox for each student on the acount-->
                <tr>
                    <td><label for="student_id[]">Student(s):</label></td>
                    <% @students.each do |s| %>
                    <td><input type="checkbox" name="student_id[]" value="<%= s.pk %>"><%= s.stud_first_name %></td>
                    <% end %><!--End student loop-->
                </tr>
                
                <!--The splitting of subjects into two code segments is purely cosmetic and temporary. The current organization allows for the label and the first three subjects to be in a row, and then for the following rows of 3 subjects to fall directly underneath the top subject row - skipping the column that holds the label. The while loop can encompass all of the subjects if subjects are to be listed in a layered format uninhibited by irrecular #s of columns for display. One long row of subjects was a nuisance during development. 
                
                    See update_activity for simplest 'all-in-one-row' code format.-->
                    
                    
                <!--List first three subjects on account (alphabetically)-->
                <tr>
                    <td><label for="subject_id[]">Subject(s):</label></td>
                    <!--Create array for subjects-->
                    <% subarray = @subjects.to_a %>
                    <!--First three items in array...-->
                    <% subarray[0..2].each do |j| %>
                    <td><input type="checkbox" name="subject_id[]" value="<%= j.pk %>"><%= j.subject_name %></td>
                    <% end %><!--End first three subjects loop-->
                </tr>
                
                <!--All remaining subject options organized three/row, skipping over the column holding the 'subjects' label-->
                <% i = 3 %>
                <% sublength = subarray.length %>
                <% while i < sublength do %>
                <tr>
                    <td></td>
                    <!--Array items 3-5, 6-8, 9-11...-->
                    <% subarray[i..(i + 2)].each do |j| %>
                    <td><input type="checkbox" name="subject_id[]" value="<%= j.pk %>"><%= j.subject_name %></td>
                    <% end %><!--End loop of 3 items-->
                    <% i += 3 %><!--Change value of i and loop again-->
                </tr>
                <% end %><!--End 'while' loop for listing of subjects-->
                <tr>
                    <td><input type="submit"></td>
                </tr>
            </table>
        </form>
        <% end %><!--End book data access-->
    </body>
</html>