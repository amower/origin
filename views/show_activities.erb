<!DOCTYPE html>
<html>
    <head>
        <meta charset='UTF-8' />
        <title>Activities</title>
    </head>
    <body>
        <% @account.all do |row| %>
        
        <a href="/home/">Home</a>
        <a href="/accounts/<%= row[:account_id] %>">Account</a>
        <a href="/dashboard/<%= row[:account_id] %>">Dashboard</a>
        <a href="/activities/<%= row[:account_id] %>">Activities</a>
        <a href="/books/<%= row[:account_id] %>">Books</a>
        <a href="/subjects/<%= row[:account_id] %>">Subjects</a>
        
        <% end %>
        
        <h1>All Activities</h1>
        
        <% @account.all do |row| %>
        <a href="/activities/new/<%= row[:account_id] %>">Add New Activity</a><br>
        <% end %>
        
        <h3>View by Subject:</h3>
        <% @subjects.each do |row| %>
            <a href="/subjects/<%= row[:account_id] %>/<%= row[:subject_id] %>"><%= row[:subject_name] %></a><br>
        <% end %>
        
        <h3><strong>2017</strong></h3>
        
        <ol>
        <% @activities.where(Sequel.like(:activity_date, "2017%")).each do |row| %>
            <li>
                <a href="/activities/<%= row[:account_id] %>/<%= row[:activity_id] %>"><%= row[:title] %> 
                    <% ActivitiesSubject.join(:subjects, :subject_id => :subject_id).where(:activity_id => row[:activity_id]).each do |row| %>
                        (<%= row[:subject_name] %>)
                    <% end %>
                    <%= row[:activity_date] %></a>
            </li>
        <% end %>
        </ol>
        
        <h3><strong>2016</strong></h3>
        
        <ol>
        <% @activities.where(Sequel.like(:activity_date, "2016%")).each do |row| %>
            <li>
                <a href="/activities/<%= row[:account_id] %>/<%= row[:activity_id] %>"><%= row[:title] %> 
                    <% ActivitiesSubject.join(:subjects, :subject_id => :subject_id).where(:activity_id => row[:activity_id]).each do |row| %>
                        (<%= row[:subject_name] %>)
                    <% end %>
                    <%= row[:activity_date] %></a>
            </li>
        <% end %>
        </ol>
    
    </body>
</html>